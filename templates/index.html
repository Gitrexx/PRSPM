<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Speech Recognition in Python</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/index.css') }}" />
</head>
<body>
<div align="center" id="speechContainer">
    <h1 align="center">SPEECH TRANSLATOR</h1>
    <div align="center" id="result">
        <form method="post">
            <input onclick="init()" type="submit" id="submitButton" value="start"/>
        </form>
    </div>
    <div id="liveData">
        <p></p>
    </div>

    {% if transcript != "" %}
        <div align="center" id="speechTranscriptContainer">
            <h3>Transcript</h3>
            <p id="speechText">{{ transcript }}</p>
        </div>
    {% endif %}

    {% if is_spoof != "" %}
        <div align="center" id="spoofJudgeContainer">
            {% if is_spoof == "Spoof!" %}
                <h1 style = "color:red" id="judgeText">{{ is_spoof }}</h1>
            {% endif %}
            {%if is_spoof == "Bonafide" %}
                <h1 style = "color:green" id="judgeText">{{ is_spoof }}</h1>
            {% endif %}
            <h3>with {{ confidence }}% confidence</h3>
        </div>
    {% endif %}

</div>
</body>
<script type="text/javascript">
 window.addEventListener('load', function()
{
    var xhr = null;

    getXmlHttpRequestObject = function()
    {
        if(!xhr)
        {
            // Create a new XMLHttpRequest object
            xhr = new XMLHttpRequest();
        }
        return xhr;
    };

    updateLiveData = function()
    {
        // Date string is appended as a query with live data
        // for not to use the cached version
        var url = '/index'
        xhr = getXmlHttpRequestObject();
        xhr.onreadystatechange = evenHandler;
        // asynchronous requests
        xhr.open("GET", url, true);
        // Send the request over the network
        xhr.send(null);
    };

    updateLiveData();

    function evenHandler()
    {
        // Check response is ready or not
        if(xhr.readyState == 4 && xhr.status == 200)
        {
            dataDiv = document.getElementById('liveData');
            // Set current data text
            dataDiv.innerHTML = xhr.responseText;
            // Update the live data every 1 sec
            setTimeout(updateLiveData(), 1000);
        }
    }
});
</script>
<script src="jquery-3.5.1.min.js"></script>
</html>